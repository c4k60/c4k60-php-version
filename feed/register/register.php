<?php// We need to use sessions, so you should always start sessions using the below code.session_start();// If the user is not logged in redirect to the login page...if (!isset($_SESSION['loggedin'])) {  } else {  header('Location: /');}?><?phprequire $_SERVER['DOCUMENT_ROOT'] . '/require/serverconnect.php';if (mysqli_connect_errno()) {	// If there is an error with the connection, stop the script and display the error.	die ('Failed to connect to MySQL: ' . mysqli_connect_error()) ;}// Now we check if the data was submitted, isset() function will check if the data exists.if (!isset($_POST['name'], $_POST['username'], $_POST['password'], $_POST['email'])) {	// Could not get the data that should have been sent.	die ('Please complete the registration form!') ;}// Make sure the submitted registration values are not empty.if (empty($_POST['name']) || empty($_POST['username']) || empty($_POST['password']) || empty($_POST['email'])) {	// One or more values are empty.	die ('Please complete the registration form') 	;}if (!filter_var($_POST['email'], FILTER_VALIDATE_EMAIL)) {	die ('Email is not valid!') ;}if (preg_match('/[A-Za-z0-9]+/', $_POST['username']) == 0) {    die ('Username is not valid!') ;}if (strlen($_POST['password']) > 20 || strlen($_POST['password']) < 5) {	die ('Password must be between 5 and 20 characters long!');}	$name = $_POST['name'];// We need to check if the account with that username exists.if ($stmt = $con->prepare('SELECT id,  password FROM accounts WHERE  username = ? ')) {	// Bind parameters (s = string, i = int, b = blob, etc), hash the password using the PHP password_hash function.	$stmt->bind_param('s', $_POST['username']);	$stmt->execute();	$stmt->store_result();	// Store the result so we can check if the account exists in the database.	if ($stmt->num_rows > 0) {		// Username already exists		$message = 'Tên tài khoản đã tồn tại vui lòng chọn tên khác!';	} else {// Username doesnt exists, insert new accountif ($stmt = $con->prepare('INSERT INTO accounts (oauth_provider, oauth_uid, name, username, password, email, profile_pic, date, verified, permission, activation_code, link, location, has_cover) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?)')) {	// We do not want to expose passwords in our database, so hash the password and use password_verify when a user logs in.	$name = $_POST['name'];  $profile_p = '/images/default_pic.jpg';  $date=date("Y-m-d");  $verified = 'no';  $permission = 'user';  $emptyy = '';  $has_cover = 'none';	$password = password_hash($_POST['password'], PASSWORD_DEFAULT);	$stmt->bind_param('ssssssssssssss', $emptyy,$emptyy,$_POST['name'], $_POST['username'], $password, $_POST['email'], $profile_p, $date, $verified, $permission,$emptyy,$emptyy,$emptyy,$has_cover);	$stmt->execute();	$message = 'Bạn đã đăng ký thành công và đã có thể đăng nhập!';} else {	// Something is wrong with the sql statement, check to make sure accounts table exists with all 3 fields.	$message = 'Could not prepare statement!';}	}	$stmt->close();} else {	// Something is wrong with the sql statement, check to make sure accounts table exists with all 3 fields.	$message = 'Could not prepare statement!';}$con->close();?><!doctype html><html lang="en">  <head>    <!-- Required meta tags -->    <meta charset="utf-8">    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400&display=swap" rel="stylesheet">    <link rel="stylesheet" href="fonts/icomoon/style.css">    <link rel="stylesheet" href="css/owl.carousel.min.css">    <!-- Bootstrap CSS -->    <link rel="stylesheet" href="css/bootstrap.min.css">    <link rel="icon" type="image/png" href="/c4k60.png">    <!-- Style -->    <link rel="stylesheet" href="css/style.css">    <title>Đăng ký tài khoản C4K60</title>  </head>  <body>      <div class="content">    <div class="container">      <div class="row">        <div class="col-md-6 order-md-2">          <img src="images/undraw_file_sync_ot38.png" alt="Image" class="img-fluid">        </div>        <div class="col-md-6 contents">          <div class="row justify-content-center">            <div class="col-md-8">              <div class="mb-4">              <h3>Đăng ký tài khoản <strong>C4K60</strong></h3>              <p class="mb-4">Mạng xã hội hàng đầu THPT Chuyên Biên Hoà. Thật đó ahihi :))</p>            </div>            <form action="register.php" method="POST">              <div class="form-group">                        <div><input type="text" class="form-control" name="name" placeholder="Họ và tên"></div>                                            </div>                    <div class="form-group">                        <input type="text" class="form-control" name="email" placeholder="Email">                                            </div>                    <div class="form-group">                        <input type="text" class="form-control" name="username" placeholder="Tên đăng nhập">                                            </div>                    <div class="form-group">                        <input type="password" class="form-control" name="password" placeholder="Mật khẩu">                                            </div>                    <div class="form-group">                        <input type="password" class="form-control" name="confirm_password" placeholder="Nhập lại mật khẩu"  >                                            </div>                            <p style="color:red;text-align:center"><?php echo $message ?></p>              <input type="submit" style="              background-color: #f2c413;    border-color: #f2c413;" value="Đăng ký" class="btn text-white btn-block btn-primary"><br>              <a href="/login">Đã có tài khoản? Đăng nhập tại đây</a>              <span class="d-block text-left my-4 text-muted"> hoặc đăng ký bằng</span>                            <div class="social-login">                <a href="#" class="facebook">                  <span class="icon-facebook mr-3"></span>                 </a>                <a href="#" class="twitter">                  <span class="icon-twitter mr-3"></span>                 </a>                <a href="#" class="google">                  <span class="icon-google mr-3"></span>                 </a>              </div>            </form>            </div>          </div>                  </div>              </div>    </div>  </div>      <script src="js/jquery-3.3.1.min.js"></script>    <script src="js/popper.min.js"></script>    <script src="js/bootstrap.min.js"></script>    <script src="js/main.js"></script>  </body></html>